**Билет 27. Объединение, пересечение, разность запросов в языке SQL**

### Операторы и их свойства
Все операторы требуют **совместимости по объединению**: одинаковое число столбцов и совпадающие типы.

- **`UNION`**  
  — Объединяет результаты двух запросов, удаляя дубликаты.  
  — Эквивалент реляционного объединения (∪).  
  ```sql
  SELECT name FROM students
  UNION
  SELECT name FROM teachers;
  ```

- **`UNION ALL`**  
  — То же, но **сохраняет дубликаты** (быстрее, так как нет сортировки).

- **`INTERSECT`**  
  — Возвращает строки, присутствующие в **обоих** запросах (аналог ∩).  
  — Удаляет дубликаты.  
  ```sql
  SELECT product_id FROM orders_2023
  INTERSECT
  SELECT product_id FROM orders_2024;
  ```

- **`EXCEPT`** (в PostgreSQL; в MySQL — `NOT EXISTS` или `LEFT JOIN`)  
  — Возвращает строки из первого запроса, отсутствующие во втором (аналог разности −).  
  ```sql
  SELECT user_id FROM all_users
  EXCEPT
  SELECT user_id FROM banned_users;
  ```

### Альтернативные реализации
- **Пересечение** через `INNER JOIN` или `WHERE EXISTS`:  
  ```sql
  SELECT a.product_id
  FROM orders_2023 a
  INNER JOIN orders_2024 b ON a.product_id = b.product_id;
  ```

- **Разность** через `LEFT JOIN ... WHERE IS NULL` или `NOT EXISTS`:  
  ```sql
  SELECT a.user_id
  FROM all_users a
  LEFT JOIN banned_users b ON a.user_id = b.user_id
  WHERE b.user_id IS NULL;
  ```

Эти альтернативы полезны в СУБД без поддержки `INTERSECT`/`EXCEPT` (например, MySQL).
